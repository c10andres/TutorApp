// Configuraci√≥n de Firebase para UDConecta - Multiplataforma
// Re-exportar desde la configuraci√≥n unificada para compatibilidad
export { 
  app, 
  database, 
  auth, 
  db,
  getFirebaseApp,
  getFirebaseDatabase,
  getFirebaseAuth,
  getFirebaseFirestore,
  checkFirebaseConnection,
  getFirebaseInstances,
  reinitializeFirebase
} from './utils/firebase-unified';

// Funci√≥n para verificar y sincronizar datos en Firebase
export const initializeFirebaseData = async (): Promise<void> => {
  try {
    console.log('üöÄ Verificando datos en Firebase...');
    
    // Importar funciones din√°micamente
    const { checkFirebaseConnection, getFirebaseDatabase } = await import('./utils/firebase-unified');
    
    // Verificar conexi√≥n primero
    const isConnected = await checkFirebaseConnection();
    if (!isConnected) {
      console.warn('‚ö†Ô∏è Firebase no est√° conectado, saltando verificaci√≥n');
      return;
    }
    
    // Obtener instancia de database de forma segura
    const database = getFirebaseDatabase();
    
    // Importar funciones de Firebase v9+ modular
    const { ref, get } = await import('firebase/database');
    
    // Verificar que la instancia de database es v√°lida
    if (!database) {
      console.error('‚ùå Firebase Database no est√° disponible');
      return;
    }
    
    // Solo verificar que existen datos, no crear nuevos
    const usersRef = ref(database, 'users');
    const usersSnapshot = await get(usersRef);
    
    if (usersSnapshot.exists()) {
      const users = usersSnapshot.val();
      console.log('‚úÖ Usuarios encontrados en Firebase:', Object.keys(users).length);
    } else {
      console.log('‚ùå No hay usuarios en Firebase');
    }
    
    const requestsRef = ref(database, 'requests');
    const requestsSnapshot = await get(requestsRef);
    
    if (requestsSnapshot.exists()) {
      const requests = requestsSnapshot.val();
      console.log('‚úÖ Solicitudes encontradas en Firebase:', Object.keys(requests).length);
    } else {
      console.log('‚ùå No hay solicitudes en Firebase');
    }
    
    console.log('‚úÖ Verificaci√≥n de datos completada');
  } catch (error) {
    console.error('‚ùå Error verificando datos en Firebase:', error);
    console.warn('‚ö†Ô∏è Continuando sin verificaci√≥n de Firebase');
  }
};

// Exportar app como default desde la configuraci√≥n unificada
import { app } from './utils/firebase-unified';
export default app;